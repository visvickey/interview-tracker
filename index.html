<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Interview HQ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #0f172a; color: #f8fafc; font-family: -apple-system, sans-serif; }
        .bento-card { background: rgba(30, 41, 59, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 24px; }
        .input-field { background: rgba(15, 23, 42, 0.6); border: 1px solid rgba(255, 255, 255, 0.1); color: white; }
        input, select { font-size: 16px !important; }
        .accent-gradient { background: linear-gradient(135deg, #38bdf8 0%, #818cf8 100%); }
    </style>
</head>
<body class="p-5 pb-24 min-h-screen">

    <header class="mb-8 flex justify-between items-center">
        <div>
            <h1 class="text-2xl font-bold tracking-tight">Interview HQ</h1>
            <p class="text-slate-400 text-xs">Calendar Integrated</p>
        </div>
        <div class="w-10 h-10 rounded-full accent-gradient flex items-center justify-center shadow-lg">
            <span class="text-xs font-bold">PRO</span>
        </div>
    </header>

    <section class="bento-card p-6 mb-8">
        <div class="space-y-4">
            <input type="text" id="name" placeholder="Candidate Name" class="input-field w-full p-4 rounded-2xl outline-none">
            <input type="text" id="position" placeholder="Position" class="input-field w-full p-4 rounded-2xl outline-none">
            
            <div class="grid grid-cols-2 gap-3">
                <select id="type" class="input-field p-4 rounded-2xl outline-none appearance-none text-sm">
                    <option value="Personal">üìç Personal</option>
                    <option value="Telephonic">üìû Telephonic</option>
                    <option value="Virtual">üíª Virtual</option>
                </select>
                <input type="datetime-local" id="interviewTime" class="input-field w-full p-4 rounded-2xl outline-none text-sm">
            </div>

            <button onclick="addCandidate()" class="accent-gradient w-full py-4 rounded-2xl font-bold text-white shadow-lg active:scale-95 transition-transform uppercase text-xs tracking-widest">
                Save Candidate
            </button>
        </div>
    </section>

    <div id="candidateList" class="space-y-4"></div>

    <script>
        let candidates = JSON.parse(localStorage.getItem('interviews_v5')) || [];

        function addCandidate() {
            const name = document.getElementById('name').value;
            const position = document.getElementById('position').value;
            const type = document.getElementById('type').value;
            const time = document.getElementById('interviewTime').value;

            if (!name || !position || !time) return alert("Fill all fields");

            candidates.push({ id: Date.now(), name, position, type, time, status: 'Pending' });
            saveAndRender();
            ['name', 'position', 'interviewTime'].forEach(id => document.getElementById(id).value = '');
        }

        // --- NEW: CALENDAR SYNC LOGIC ---
        function syncToCalendar(name, position, type, time) {
            const startDate = new Date(time).toISOString().replace(/-|:|\.\d+/g, "");
            const endDate = new Date(new Date(time).getTime() + 60 * 60 * 1000).toISOString().replace(/-|:|\.\d+/g, ""); // 1 hour duration
            
            // Create .ics file content
            const icsMsg = `BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
URL:${window.location.href}
DTSTART:${startDate}
DTEND:${endDate}
SUMMARY:Interview: ${name} (${position})
DESCRIPTION:Type: ${type} round.
LOCATION:${type}
BEGIN:VALARM
TRIGGER:-PT60M
ACTION:DISPLAY
DESCRIPTION:Reminder
END:VALARM
BEGIN:VALARM
TRIGGER:-PT15M
ACTION:DISPLAY
DESCRIPTION:Reminder
END:VALARM
END:VEVENT
END:VCALENDAR`;

            // Trigger Download for iOS
            const blob = new Blob([icsMsg], { type: 'text/calendar;charset=utf-8' });
            const link = document.createElement('a');
            link.href = window.URL.createObjectURL(blob);
            link.setAttribute('download', 'interview.ics');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function saveAndRender() {
            localStorage.setItem('interviews_v5', JSON.stringify(candidates));
            render();
        }

        function deleteCandidate(id) {
            if(confirm("Remove?")) {
                candidates = candidates.filter(c => c.id !== id);
                saveAndRender();
            }
        }

        function render() {
            const list = document.getElementById('candidateList');
            list.innerHTML = '';
            
            candidates.sort((a, b) => new Date(a.time) - new Date(b.time)).forEach(c => {
                const dateObj = new Date(c.time);
                const timeStr = dateObj.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                
                list.innerHTML += `
                    <div class="bento-card p-5">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <h3 class="font-bold text-lg">${c.name}</h3>
                                <p class="text-xs text-slate-400">${c.position} ‚Ä¢ ${timeStr}</p>
                            </div>
                            <button onclick="syncToCalendar('${c.name}', '${c.position}', '${c.type}', '${c.time}')" 
                                    class="bg-sky-500/20 text-sky-400 px-3 py-2 rounded-xl text-[10px] font-bold">
                                üóìÔ∏è SYNC CAL
                            </button>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="deleteCandidate(${c.id})" class="flex-1 bg-white/5 py-3 rounded-xl text-xs opacity-50">Delete</button>
                        </div>
                    </div>
                `;
            });
        }
        render();
    </script>
</body>
</html>
